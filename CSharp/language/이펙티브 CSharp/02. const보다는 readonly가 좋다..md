# Item 2. const보다는 readonly가 좋다.
> Chapter 1. 언어 요소

- `C#`은 **컴파일타임 상수**와 **런타임 상수** 두 유형의 상수를 가진다.
- **컴파일타임 상수**가 약간 더 빠르긴 하지만, 유연성이 떨어지기 때문에 **런타임 상수**를 사용하는 것이 좋다.
- **컴파일타임 상수**는 성능이 매우 중요하고 상수의 값이 절대 바뀌지 않을 경우에만 제한적으로 사용하는 것이 좋다.

```cs
//컴파일 타임 상수
public const int Millennium = 2000;

//런타임 상수
public static readonly int ThisYear = 2023;
```

### 컴파일타임 상수 const
- **메서드 내부**에서도 선언할 수 있다.
- 컴파일타임에 변수가 **값으로 대체**된다.
- **내장 자료형**이여야만 컴파일타임에 상수를 리터럴로 대체할 수 있기 때문에, 내장된 숫자형, enum, 문자열, null에 대해서만 사용될 수 있다.
- 다른 어셈블리의 참조 여부와 상관없이 항상 숫자나 문자열 등을 직접 사용한 것과 **완전히 동일한 IL 코드**를 생성한다.

```cs
private const DateTime classCreation = new DateTime(2000,  1, 1, 0, 0, 0);
//컴파일 되지 않음
```

### 런타임 상수 readonly
- **메서드 내**에서는 선언할 수 없다.
- 런타임에 값이 평가된다.
- 컴파일타임에 값으로 대체되지 않고 **상수에 대한 참조**로 컴파일된다.
- **생성자**에서 초기화 될 수 있고, 그 이후에는 수정할 수 없다.
- **어떤 타입**과도 함께 사용될 수 있다.

</br>

---

</br>

- `C#` 컴파일러는 `const`에 대해 **값으로 대체**하고, `readonly`에 대해 값의 **참조 코드로 대체**한다.
- 따라서 `readonly`는 어셈블리만을 배포하는 것만으로도 전체 응용프로그램이 수정된 값을 사용하게 된다.
- `public`으로 선언된 컴파일타임 상수의 값을 수정할 때는 타입의 인터페이스를 변경하는 것만큼이나 신중해야 하며 해당 상수를 참조하는 모든 코드를 반드시 재컴파일 해야 한다.
- `const`는 `readonly`보다 성능이 빠르지만, 개선효과가 크지 않고 유연성을 해치는 단점을 가지고 있다. (`BenchmarkDotNet`으로 성능을 측정해보면 도움이 된다.)

### 정리

- 컴파일할 때 사용되는 상숫값을 정의할 때는 반드시 `const`를 사용해야 한다.
- 특성의 매개변수, `switch/case` 문의 레이블, `enum` 정의 시 사용하는 상수 등은 컴파일 시에 사용돼야 하므로 반드시 `const`를 통해 초기화 되어야 한다.
- 이러한 용도로 활용되는 상숫값들은 거의 수정되지 않는다.
- 몇 가지 예외적인 상황을 제외한다면 대부분의 경우 `const`보다는 `readonly`를 사용하는 것이 좋다.
